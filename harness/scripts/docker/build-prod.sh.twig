#!/bin/bash

docker_build_prod() {
  set -o pipefail
  if [ "{{ @('docker.experimental.multiplatform_build.enabled') }}" == "yes" ]; then
    passthru docker buildx bake --file docker-bake.hcl
  else
    passthru docker build --tag {{ @('docker.repository') }}:{{ @('docker.tagPrefix') }}{{ @('app.version') }} --file .my127ws/docker/image/app/Dockerfile --target prod .
  fi
}

docker_build_prod
