attributes.default:
  app:
    binary: app
    src_path: .
    module_path: = @('app.src_path')
    health_port: 80
    services: []
    default_port:
      name: http
      port: 80
    ingress:
      # possible ingress types are standard, istio, or ~ for none
      # note istio requires a cluster that has istio configured as the ingress controller
      type: standard
      protocol: = @('app.default_port.protocol')

  domain: my127.site
  hostname: = @('namespace') ~ '.' ~ @('domain')

  database:
    # possible platforms are mysql, postgres or ~ for none
    platform: postgres
    host: postgres
    user: app
    pass: app
    name: app
    root_pass: DV6RdNY3QcFsBk7V

  docker:
    config: null # deprecated
    # If using gitops helm chart repositories, it's recommended to put this configuration
    # in the values.yml in there now instead of project application repositories
    image_pull_config: = @('docker.config')
    registry_url: = get_docker_registry(@('docker.repository'))
    repository: = @("workspace.name")
    tagPrefix: = ''

  go:
    version: 1.13
  
  helm:
    additional_schema_locations: https://inviqa.github.io/kubernetes-json-schema/schema
    feature:
      # Note: be very careful considering disabling this, as in most cases
      # it causes the secrets in it to be stored plaintext on filesystem
      # or in helm chart repositories
      # requires sealed-secrets k8s operator
      sealed_secrets: true
    timeout: 300

    sealed_secrets:
      controller_name: sealed-secrets
      controller_namespace: sealed-secrets
  
  jenkins:
    credentials:
      my127ws_key: = @('workspace.name') ~ '-my127ws-key'

  # these settings are only relevant when the respective service is enabled in
  # app.services
  persistence:
    mysql:
      enabled: true
      accessMode: ReadWriteOnce
      size: 4Gi
    postgres:
      enabled: true
      accessMode: ReadWriteOnce
      size: 4Gi

  pipeline:
    publish:
      enabled: no
    preview:
      enabled: no
      namespace: = @('workspace.name') ~ '-' ~ slugify(branch())
      hostname:  = @('pipeline.preview.namespace') ~ '.example.com'
    base:
      resourcePrefix: ~
      hostname: = @('pipeline.base.namespace') ~ '.example.com'
    qa:
      enabled: no
      namespace: = @('workspace.name') 
      hostname: = @('pipeline.qa.namespace') ~ '.' ~ @('domain')
      resourcePrefix: ~

  resources:
    requests:
      memory:
        mysql: "512Mi"
        postgres: "512Mi"
    limits:
      memory:
        mysql: "512Mi"
        postgres: "512Mi"
