{% set blocks  = '_twig/docker-compose.yml/' %}
{% set dockersync = false %}
{% if @('host.os') == 'darwin' and @('docker-sync') == 'yes' %}
{% set dockersync = true %}
{% endif %}
version: '3.7'
services:
{% include blocks ~ 'application.yml.twig' %}
{% for service in @('app.services') %}
{% include blocks ~ 'service/' ~ service ~ '.yml.twig' %}
{% endfor %}
networks:
  private:
    external: false
  shared:
    external:
      name: my127ws
{% if dockersync or @('pact.enabled') %}
volumes:
{% if @('pact.enabled') %}
  pacts: ~
{% endif %}
{% if dockersync %}
  {{ @('workspace.name') }}-sync:
    external: true
{% endif %}
{% endif %}
